<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Forum</title>
</head>
<body>
<h1>Forum</h1><hr>
<p>Welcome to the Forum Page</p>
<button id="newPost">New Post</button>
<!--<button id="delete">Delete Post</button>-->
<button id="backButton">Go back</button>

<!-- The Modal -->
<div id="myModal" class="modal" style="display: none;">
    <div class="modal-content">
        <textarea id="postContent" placeholder="Write something here" rows="4" cols="50"></textarea><br>
        <button id="cancelPost">Cancel</button>
        <button id="savePost">Post</button>
    </div>
</div>

<!-- POST LIST -->
<div id="postList"></div>

<script>
    // Show modal
    document.getElementById("newPost").addEventListener("click", function() {
        document.getElementById("myModal").style.display = "block";
    });

    // Cancel button
    document.getElementById("cancelPost").addEventListener("click", function() {
        document.getElementById("postContent").value = "";
        document.getElementById("myModal").style.display = "none";
    });

    // Save post
    document.getElementById("savePost").addEventListener("click", function () {
        const post = document.getElementById("postContent").value;
        if (post.trim() !== "") {
            let posts = JSON.parse(localStorage.getItem("posts")) || [];
            posts.push(post);
            localStorage.setItem("posts", JSON.stringify(posts));
            alert("Post saved!");

            document.getElementById("postContent").value = "";
            document.getElementById("myModal").style.display = "none";

            loadPosts();
        } else {
            alert("Post cannot be empty.");
        }
    });

    // Load saved posts
    function loadPosts() {
        let posts = JSON.parse(localStorage.getItem("posts")) || [];
        let postListDiv = document.getElementById("postList");
        postListDiv.innerHTML = "";
        posts.forEach((post, index) => {
            const p = document.createElement("p");
            p.textContent = `Post ${index + 1}: ${post}`;

            const deleteBtn = document.createElement("button");
            deleteBtn.textContent = "Delete";
            deleteBtn.style.marginLeft = "10px";

            deleteBtn.addEventListener("click", () => {
                posts.splice(index, 1);
                localStorage.setItem("posts", JSON.stringify(posts));
                loadPosts();
            });


            postListDiv.appendChild(p);
            p.appendChild(deleteBtn);
        });
    }

    window.onload = loadPosts;

    window.addEventListener("click", function(event) {
        let modal = document.getElementById("myModal");
        if (event.target == modal) {
            modal.style.display = "none";
        }
    });

    document.getElementById("backButton").addEventListener("click", function() {
        window.history.back();
    });
</script>

</body>
</html>