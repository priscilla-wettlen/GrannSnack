<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Forum</title>
</head>
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    }

    body {
        background-color: #f2f2f2;
        color: white;
        padding: 20px;
        max-width: 900px;
        margin: 0 auto;
    }
    h1 {
        font-size: 32px;
        margin-bottom: 30px;
        color: #5a5a4a;
        font-weight: 600;
        line-height: 1.2;
    }
    #postList{
        padding: 2rem 0 2rem 0;
        max-width: 100vw;
    }
    p{
        background-color: ghostwhite;
        padding: 10px;
        border-radius: 10px;
        font-size: 16px;
        color: #777;
        margin: 10px 0 20px 0;
    }
    #newPost,
    #backButton{
        font-size: 18px;
        padding: 5px;
    }
</style>
<body>
<h1>Forum</h1><hr>
<button id="newPost">New Post</button>
<!--<button id="delete">Delete Post</button>-->
<button id="backButton">Go back</button>

<!-- The Modal -->
<div id="myModal" class="modal" style="display: none;">
    <div class="modal-content">
        <textarea id="postContent" placeholder="Write something here" rows="4" cols="50"></textarea><br>
        <button id="cancelPost">Cancel</button>
        <button id="savePost">Post</button>
    </div>
</div>

<!-- POST LIST -->
<div id="postList"></div>

<script>
    // Show modal
    document.getElementById("newPost").addEventListener("click", function() {
        document.getElementById("myModal").style.display = "block";
    });

    // Cancel button
    document.getElementById("cancelPost").addEventListener("click", function() {
        document.getElementById("postContent").value = "";
        document.getElementById("myModal").style.display = "none";
    });

    // Save post
    document.getElementById("savePost").addEventListener("click", function () {
        const post = document.getElementById("postContent").value;
        if (post.trim() !== "") {
            let posts = JSON.parse(localStorage.getItem("posts")) || [];
            posts.push(post);
            localStorage.setItem("posts", JSON.stringify(posts));
            alert("Post saved!");

            document.getElementById("postContent").value = "";
            document.getElementById("myModal").style.display = "none";

            loadPosts();
        } else {
            alert("Post cannot be empty.");
        }
    });

    // Load saved posts
    function loadPosts() {
        let posts = JSON.parse(localStorage.getItem("posts")) || [];
        let postListDiv = document.getElementById("postList");
        postListDiv.innerHTML = "";
        posts.forEach((post, index) => {
            const p = document.createElement("p");

            p.textContent = `Post ${index + 1}: ${post}`;

            const deleteBtn = document.createElement("button");
            deleteBtn.textContent = "Delete";
            deleteBtn.style.marginLeft = "10px";

            deleteBtn.addEventListener("click", () => {
                posts.splice(index, 1);
                localStorage.setItem("posts", JSON.stringify(posts));
                loadPosts();
            });


            postListDiv.appendChild(p);
            p.appendChild(deleteBtn);
        });
    }

    window.onload = loadPosts;

    window.addEventListener("click", function(event) {
        let modal = document.getElementById("myModal");
        if (event.target == modal) {
            modal.style.display = "none";
        }
    });

    document.getElementById("backButton").addEventListener("click", function() {
        window.history.back();
    });
</script>

</body>
</html>