<!DOCTYPE html>
<html lang="sv" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Admin</title>
</head>
<body>
<h1>Admin Homepage</h1><hr>
<p>Welcome to the Admin Home Page</p>

<button id="clickme">click</button>
<div id="user-container"></div>
<div id="user-item"></div>

<script>
    document.addEventListener("DOMContentLoaded", () => {
       const btn =  document.getElementById("clickme");
       btn.addEventListener("click", getAllUsers)
    })

    function getAllUsers(){
        fetch("http://localhost:8080/a/home/users",{
            method: "GET"
        }).then(res =>{
            if(!res.ok) throw new Error("Error: Användarlistan kunde inte hämtas.");
            return res.json();
        }).then(users => {
            const userContainer = document.getElementById("user-container");
            userContainer.innerHTML = "";
            let userContainerTitle = document.createElement("H3");
            userContainerTitle.innerText = "Registrerade användarna"

            users.forEach(user => {
                const userItem = document.createElement("div");
                userItem.className = "user-item";
                userItem.textContent = `User: ${user.id} ${user.name} ${user.email} `;

                const deleteUserBtn = document.createElement('button');
                deleteUserBtn.textContent = 'Delete';
                deleteUserBtn.addEventListener("click", deleteUser);

                userContainer.appendChild(userContainerTitle);
                userItem.appendChild(deleteUserBtn);
                userContainer.appendChild(userItem);
            })

        }).catch(error => {
            console.error("Failed to fetch users:", error);
            const userContainer = document.getElementById("user-container");
            userContainer.innerHTML = `<p>Error loading users: ${error.message}</p>`;
        });
    }

    function deleteUser(){
        fetch()
    }
</script>
</body>
</html>